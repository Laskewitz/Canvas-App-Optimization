## Rules for the Code Review Tool

| Pattern ID                     | Pattern Details                | Pattern Category | Pattern Type   | Pattern Score | Pattern Severity | Pattern Description                                                                                                                                                                                                                     | Pattern Recommendation                                                                                                                                                                                                                 | Documentation Link                                                                                     |
|--------------------------------|--------------------------------|------------------|----------------|---------------|------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------|
| app-FormulaOptimization-NestedFilter | Nested Filters             | Performance      | PowerAppsPattern | 1             | Medium           | Consider simplifying nested formulas with Search() and Filter() operations. Avoiding the nesting of these two together leads to a more compact/concise formula and performance improvement. | Simplify nested filters to improve performance. Combine multiple conditions into a single `Filter()` or `Search()` call to optimize data retrieval. Where possible, apply filtering at the data source level (e.g., using delegation-friendly queries) to improve performance and reduce processing load in Power Apps. |                                                                                                        |
| app-UxLayout                  | UX Layout                    | UX               | PowerAppsPattern | 1             | Low              | This pattern checks for use of layout containers in your app to determine if your app is responsive.                                                                                           | Using layout containers can significantly enhance the design and functionality of your apps. Responsive design, organized structure, improved accessibility, and enhanced performance are key benefits.                                 | [Link](https://learn.microsoft.com/powerapps/maker/canvas-apps/create-responsive-layout)             |
| flow-TriggerTypes             | Trigger Types               | Functionality    | FlowPattern     | 1             | Low              | Validate the types of triggers used in the flow.                                                                                                                                                                                        | Ensure that the triggers are appropriate for the intended use of the flow.                                                                                                                                                             | [Link](https://learn.microsoft.com/power-automate/trigger-types)                                                                            |
| bot-TriggerPhraseCount        | Trigger Phase Count          | Functionality    | BotPattern      | 1             | Medium           | Topics should contain at least 5-10 trigger phrases to ensure that the agent can effectively respond to a wide variety of user inputs. More trigger phrases improve the chances of the agent activating the correct topic.              | Ensure each topic has at least 5-10 trigger phrases.                                                                                                                                                                                    | [Link](https://learn.microsoft.com/microsoft-copilot-studio/guidance/trigger-phrases-best-practices#2) |
| bot-LongPhrases               | Long Phrases                | Functionality    | BotPattern      | 1             | Low              | Avoid long trigger phrases. Trigger phrases exceeding 10 words in length can have negative impact on the topic recognition and the agent performance.                                                                                   |                                                                                                                                                                                                                                         | [Link](https://learn.microsoft.com/microsoft-copilot-studio/guidance/trigger-phrases-best-practices#4) |
| bot-ConditionCount            | Condition Count             | BotPattern       | Medium         | 1             | Medium           | Avoid large amount of conditions per topic. Large amount of conditions within single topic can have negative impact on the agent performance.                                                                                          | Consider breaking the topic into subtopics and redirect the conversation to those subtopics to improve maintainability and ensure good performance.                                                                                     | [Link](https://learn.microsoft.com/microsoft-copilot-studio/guidance)                           |
| bot-FlowCount                 | Flow Count                  | BotPattern       | Medium         | 1             | Medium           | Avoid large amount of flows within an agent. Large amount of flows can increase latencies and have negative impact on the end user performance.                                                                                        | Recommendation is to avoid slow logic in a flow and limit the number of flows per agent to 10 or less if possible, to ensure good end user performance.                                                                                 |                                                                                                        |
| bot-SharePointAuthMode        | SharePoint Authentication Mode | Security         | High           | 1             | High             | SharePoint sites cannot be used as knowledge source unless the agent requires/allows authentication.                                                                                                                                   | Ensure that authentication is enabled for agents using SharePoint sites as knowledge source.                                                                                                                                           | [Link](https://learn.microsoft.com/microsoft-copilot-studio/guidance)                           |
| bot-UnusedTopics              | Unused Topics               | Functionality    | Medium         | 1             | Medium           | Topics that do not have trigger phrases and are not redirected to from other topics, are likely unused and could be removed.                                                                                                           | Unused topics clutter the user interface for the maker, and could be a source of confusion. Large amounts of unused topics could have impact on agent performance. After reviewing them and confirming that they are not in use, remove them. | [Link](https://learn.microsoft.com/microsoft-copilot-studio/guidance)                           |
| bot-SynonymsQuality           | Synonyms Quality            | Functionality    | Medium         | 1             | Medium           | Synonyms should be keywords only, and entering longer phrases as synonyms should be avoided.                                                                                                                                           | Make sure to only enter keywords as synonyms. In most cases they should be single word in length.                                                                                                                                      | [Link](https://learn.microsoft.com/microsoft-copilot-studio/guidance)                           |
| bot-DuplicateRegexEntities    | Duplicate Regex Entities    | Functionality    | Medium         | 1             | Medium           | Different entities should not have the same exact regular expression pattern.                                                                                                                                                          | Regular expressions for entities should be unique within single agent. Having multiple entities with same pattern can be a source of confusion or conflict.                                                                             | [Link](https://learn.microsoft.com/microsoft-copilot-studio/guidance)                           |
| app-InefficientDelayLoading   | Cross screen dependencies   | Performance      | Medium         | 1             | Medium           | Cross page references force the load of additional screens if one screen has a dependency on a control in a different screen.                                                                                                          | Keep cross screen dependencies between screens low. Use variable & collection rather than values from controls properties.                                                                                                              | [Link](https://learn.microsoft.com/power-apps/maker/canvas-apps/fast-app-page-load)             |
| app-UnusedMediaResources      | Unused Media Resources      | Performance      | Low            | 1             | Low              | The app contains media (.jpg, .jpeg, .gif, .png, .bmp, .tif, .tiff, .svg, .wav, .mp3, .mp4) that have been uploaded to the app but not used in any screen.                                                                               | You can remove all unused media from the app to clean up or reduce the size of the app using the "Remove unused media" option.                                                                                                           | [Link](https://learn.microsoft.com/power-apps/maker/canvas-apps/add-images-pictures-audio-video) |
| bot-EndOfConversationReference | End Of Conversation Usage  | Usage            | High           | 1             | High             | Checks if there is at least one End Of Conversation topic (with CancelOtherTopics and a Resolved outcome), and at least one topic referencing it.                                                                                      | Ensure you have an EndOfConversation topic with 'startBehavior: CancelOtherTopics' and conversationOutcome: ResolvedImplied Or conversationOutcome: ResolvedConfirmed and it is referenced by at least one topic to properly end the conversation. | [Link](https://learn.microsoft.com/microsoft-copilot-studio/guidance)                           |
| flow-MultipleInitializeVariableActions | Multiple Initialize Variable Actions | Coding Standards | Low            | 1             | Low              | Check if 'Initialize Variable' actions are used more than once. Combine them into one action for efficiency or use parallel initialization for faster execution.                                                                        | Combine multiple 'InitializeVariable' actions into a single 'InitializeVariable' action of type object or use parallel initialization for faster execution.                                                                             | [Link](https://learn.microsoft.com/power-automate/guidance/coding-guidelines/use-data-operations#json-variables-vs-individual-variables) |
| flow-ActionNote               | Action Note                | Maintainability  | Low            | 1             | Low              | Ensure every action has a non-empty description. Adding meaningful notes/descriptions enhances documentation and maintainability.                                                                                                       | Add meaningful notes/descriptions to all actions for better documentation and maintainability.                                                                                                                                         | [Link](https://learn.microsoft.com/power-automate/guidance/coding-guidelines/use-peekcode-addnotes#add-notes) |

